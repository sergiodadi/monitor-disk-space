monitor-disk-space
monitor-disk-space.sh - Disk space monitoring across multiple servers via SSH with email alerts
Disk Space Monitor
Version: 2.6
Description
Linux disk space monitoring script. Checks disk space on multiple servers via SSH and sends email alerts.
Example email report
To see an example HTML report generated by this script:
View online: Example HTML Report
Features

Multi-server monitoring via SSH
HTML report generation
Email alerts based on usage thresholds
Identification of largest directories and files
Log rotation with compression

Usage
bash./monitor-disk-space.sh [OPTIONS]
Configuration
Modify the files:

/usr/local/etc/disk-monitor.conf: Main configuration
/usr/local/etc/server-disk-space.conf: Server list

Options
bashOptions:
  -c, --critical [NUMBER]       Critical threshold in % (default: 90)
  -C, --critical-email [EMAIL]  Email for critical level alerts
  -d, --days [NUMBER]           Days before recalculating large directories/files (default: 7)
  -D, --no-dirs                 Disable calculation of large directories
  -E, --exclude-servers "LIST"  List of servers to exclude from intensive calculations (format: "server1,server2,...")
  -f, --num-big-files [NUMBER]  Number of large files to display (default: 3)
  -F, --no-files                Disable calculation of large files
  -h, --help                    Display this help message
  -I, --info-email [EMAIL]      Email for reports with no alerts
  -l, --list-server             List configured servers
  -m, --max-logs [NUMBER]       Maximum number of log files to keep (default: 30)
  -M, --mail-big-files [EMAIL]  Send a consolidated list of largest files
  -n, --num-big-dirs [NUMBER]   Number of large directories to display (default: 3)
  -P, --mail-big-dirs [EMAIL]   Send a consolidated list of largest directories
  -r, --rotate-logs             Enable log file rotation
  -R, --no-rotate-logs          Disable log file rotation
  -S, --skip-normal             Do not send email if no threshold is reached
  -t, --test                    Test mode with alternative configuration file
  -T, --timing                  Display processing time for each server
  -v, --verbose                 Verbose mode (detailed log)
  -V, --version                 Display script version
  -w, --warning [NUMBER]        Warning threshold in % (default: 75)
  -W, --warning-email [EMAIL]   Email for warning level alerts
  -x, --compress-logs           Enable compression of old log files
  -X, --no-compress-logs        Disable compression of old log files
  -z, --zero-calc               Reset the calculation of large directories and files
Server configuration file format
server:partitions:warning_threshold:critical_threshold
Examples:

server1 - Checks only the / partition with default thresholds
server2:/var,/home - Checks / and specified partitions with default thresholds
server3:/var:60:85 - Checks / and /var with custom thresholds (60% and 85%)

Installation

Copy the script to an appropriate directory (e.g., /usr/local/bin/)
Make it executable: chmod +x /usr/local/bin/monitor-disk-space.sh
Create configuration files in /usr/local/etc/
Create directory for logs: mkdir -p /var/log/monitor-disk-space

Security
This script requires SSH key access to monitored servers. Make sure to properly configure SSH keys for the user who will execute the script.
AI
The AI Claude was very helpful...
