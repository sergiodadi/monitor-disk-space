# monitor-disk-space
monitor-disk-space.sh - Disk space monitoring on multiple servers via SSH with email alerts

# Disk Space Monitor

Version: 2.6

## Description
Disk space monitoring script for Linux servers. Checks disk space on multiple servers via SSH and sends email alerts.

## Example email report

To see an example of the HTML report generated by this script:

**View online**: [HTML report example](https://sergiodadi.github.io/monitor-disk-space/monitor-disk-space-exemple.html)

## Features
- Multi-server monitoring via SSH
- HTML report generation
- Email alerts based on usage thresholds
- Identification of largest directories and files
- Log rotation with compression

## Usage

./monitor-disk-space.sh [OPTIONS]

## Configuration
Edit the files:

- /usr/local/etc/disk-monitor.conf : Main configuration
- /usr/local/etc/server-disk-space.conf : Server list

## Options
Options:
-  -c, --critical [NUMBER]       Critical threshold in % (default: 90)
-  -C, --critical-email [EMAIL]  Email for critical level alerts
-  -d, --days [NUMBER]           Days before recalculating large directories/files (default: 7)
-  -D, --no-dirs                 Disables large directory calculation
-  -E, --exclude-servers "LIST"  List of servers to exclude from intensive calculations (format: "server1,server2,...")
-  -f, --num-big-files [NUMBER]  Number of large files to display (default: 3)
-  -F, --no-files                Disables large file calculation
-  -h, --help                    Shows this help message
-  -I, --info-email [EMAIL]      Email for reports without alerts
-  -l, --list-server             Lists configured servers
-  -m, --max-logs [NUMBER]       Maximum number of log files to keep (default: 30)
-  -M, --mail-big-files [EMAIL]  Sends a consolidated list of largest files
-  -n, --num-big-dirs [NUMBER]   Number of large directories to display (default: 3)
-  -P, --mail-big-dirs [EMAIL]   Sends a consolidated list of largest directories
-  -r, --rotate-logs             Enables log file rotation
-  -R, --no-rotate-logs          Disables log file rotation
-  -S, --skip-normal             Don't send email if no threshold is reached
-  -t, --test                    Test mode with alternate configuration file
-  -T, --timing                  Shows processing time for each server
-  -v, --verbose                 Verbose mode (detailed log)
-  -V, --version                 Shows script version
-  -w, --warning [NUMBER]        Warning threshold in % (default: 75)
-  -W, --warning-email [EMAIL]   Email for warning level alerts
-  -x, --compress-logs           Enables old log file compression
-  -X, --no-compress-logs        Disables old log file compression
-  -z, --zero-calc               Resets large directory and file calculations

## Server configuration file format
server:partitions:warning_threshold:critical_threshold
Examples:

- server1 - Checks only / partition with default thresholds
- server2:/var,/home - Checks / and specified partitions with default thresholds
- server3:/var:60:85 - Checks / and /var with custom thresholds (60% and 85%)

## Installation
- Copy the script to an appropriate directory (ex: /usr/local/bin/)
- Make it executable: chmod +x /usr/local/bin/monitor-disk-space.sh
- Create configuration files in /usr/local/etc/
- Create log directory: mkdir -p /var/log/monitor-disk-space

## Security
This script requires SSH key access to monitored servers. Make sure to properly configure SSH keys for the user who will run the script.

## AI
Claude AI helped me a lot...
